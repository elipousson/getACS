<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='make_area_xwalk() creates a crosswalk data frame based on the weight_col
parameter (if year = 2020, use "POP20" for population, "HOUSING20" for
households, or "ALAND20" for land area). Using this function with other
years, requires users to add population data to the block_xwalk as the
tigris::blocks() function only includes population and household count data
for the 2020 year. This function has also not been tested when areas include
overlapping geometry and the results may be invalid for those overlapping
areas if that is the case.'><title>Make and use crosswalk data based on U.S. Census block-level weights for U.S. Census tracts and non-Census geographic areas — make_area_xwalk • getACS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Make and use crosswalk data based on U.S. Census block-level weights for U.S. Census tracts and non-Census geographic areas — make_area_xwalk"><meta property="og:description" content='make_area_xwalk() creates a crosswalk data frame based on the weight_col
parameter (if year = 2020, use "POP20" for population, "HOUSING20" for
households, or "ALAND20" for land area). Using this function with other
years, requires users to add population data to the block_xwalk as the
tigris::blocks() function only includes population and household count data
for the 2020 year. This function has also not been tested when areas include
overlapping geometry and the results may be invalid for those overlapping
areas if that is the case.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">getACS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01_introduction.html">1. Introduction to getACS</a>
    <a class="dropdown-item" href="../articles/02_gt-tables.html">2. Creating gt tables</a>
    <a class="dropdown-item" href="../articles/03_area-xwalk.html">3. Interpolating ACS data using an area crosswalk</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/elipousson/getACS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Make and use crosswalk data based on U.S. Census block-level weights for U.S. Census tracts and non-Census geographic areas</h1>
      <small class="dont-index">Source: <a href="https://github.com/elipousson/getACS/blob/HEAD/R/xwalk.R" class="external-link"><code>R/xwalk.R</code></a></small>
      <div class="d-none name"><code>make_area_xwalk.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>make_area_xwalk()</code> creates a crosswalk data frame based on the <code>weight_col</code>
parameter (if <code>year = 2020</code>, use "POP20" for population, "HOUSING20" for
households, or "ALAND20" for land area). Using this function with other
years, requires users to add population data to the block_xwalk as the
<code><a href="https://rdrr.io/pkg/tigris/man/blocks.html" class="external-link">tigris::blocks()</a></code> function only includes population and household count data
for the 2020 year. This function has also not been tested when areas include
overlapping geometry and the results may be invalid for those overlapping
areas if that is the case.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">make_area_xwalk</span><span class="op">(</span></span>
<span>  <span class="va">area</span>,</span>
<span>  block_xwalk <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  state <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  county <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2020</span>,</span>
<span>  name_col <span class="op">=</span> <span class="st">"NAME"</span>,</span>
<span>  weight_col <span class="op">=</span> <span class="st">"HOUSING20"</span>,</span>
<span>  geoid_col <span class="op">=</span> <span class="st">"GEOID"</span>,</span>
<span>  tract_col <span class="op">=</span> <span class="st">"TRACTCE20"</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>TRACTCE20 <span class="op">=</span> <span class="st">"TRACTCE"</span><span class="op">)</span>,</span>
<span>  suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_block"</span>, <span class="st">"_tract"</span><span class="op">)</span>,</span>
<span>  placement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"largest"</span>, <span class="st">"surface"</span>, <span class="st">"centroid"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  extensive <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  coverage <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  erase <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  area_threshold <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  keep_geometry <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">use_area_xwalk</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">area_xwalk</span>,</span>
<span>  geography <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>  name_col <span class="op">=</span> <span class="st">"NAME"</span>,</span>
<span>  geoid_col <span class="op">=</span> <span class="st">"GEOID"</span>,</span>
<span>  suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_area"</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>  weight_col <span class="op">=</span> <span class="st">"perc_HOUSING20"</span>,</span>
<span>  variable_col <span class="op">=</span> <span class="st">"variable"</span>,</span>
<span>  value_col <span class="op">=</span> <span class="st">"estimate"</span>,</span>
<span>  moe_col <span class="op">=</span> <span class="st">"moe"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  perc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  extensive <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>area</dt>
<dd><p>A sf object with an arbitrary geography overlapping with the
block_xwalk. Required. If area only partly overlaps with block_xwalk,
coverage should be set to <code>TRUE</code> (default).</p></dd>


<dt>block_xwalk</dt>
<dd><p>Block-tract crosswalk sf object. If <code>NULL</code>, state is
required to create a crosswalk using <code><a href="make_block_xwalk.html">make_block_xwalk()</a></code></p></dd>


<dt>state</dt>
<dd><p>The two-digit FIPS code (string) of the state you want. Can also
be state name or state abbreviation.</p></dd>


<dt>county</dt>
<dd><p>The three-digit FIPS code (string) of the county you'd like to
subset for, or a vector of FIPS codes if you desire multiple counties.
Can also be a county name or vector of names.</p></dd>


<dt>year</dt>
<dd><p>the data year; defaults to 2021</p></dd>


<dt>name_col</dt>
<dd><p>Name column in area.</p></dd>


<dt>weight_col</dt>
<dd><p>Column name in input block_xwalk to use for weighting.
Generated weight_col used by <code>use_area_xwalk()</code> should be the same as the
weight_col for <code>make_area_xwalk()</code> but include the "perc_" prefix. Defaults
to "HOUSING20" for <code><a href="make_block_xwalk.html">make_block_xwalk()</a></code> and "perc_HOUSING20" for
<code>use_area_xwalk()</code>.</p></dd>


<dt>geoid_col, tract_col</dt>
<dd><p>GeoID for Census tract and Census tract ID column
in block_xwalk</p></dd>


<dt>by</dt>
<dd><p>Specification of join variables in the format of c("block column
name for tract" = "tract column name"). Passed to <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">dplyr::left_join()</a></code>.</p></dd>


<dt>suffix</dt>
<dd><p>Suffixes added to the output to disambiguate column names from
the block and tract data. Unused for 2020 data.</p></dd>


<dt>placement</dt>
<dd><p>String with option for joining <code>area</code> and <code>block_xwalk</code>:
"largest", "surface", or "centroid". "largest" joins the two using
<code><a href="https://r-spatial.github.io/sf/reference/st_join.html" class="external-link">sf::st_join()</a></code> with largest set to <code>TRUE</code>. "surface" first transforms
block_xwalk using <code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">sf::st_point_on_surface()</a></code> and "centroid" uses
<code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">sf::st_centroid()</a></code>.</p></dd>


<dt>digits</dt>
<dd><p>Digits to use for percent share of weight value.</p></dd>


<dt>extensive</dt>
<dd><p>If <code>TRUE</code> (default) calculate new estimate values as
weighted sums and re-calculate margin of error with
<code><a href="https://walker-data.com/tidycensus/reference/moe_sum.html" class="external-link">tidycensus::moe_sum()</a></code>. If <code>FALSE</code>, calculate new estimate values as
weighted means (appropriate for ACS median variables) and drop the margin
of error. <code>perc</code> is also always set to <code>FALSE</code> if extensive is <code>FALSE</code>.</p></dd>


<dt>coverage</dt>
<dd><p>If <code>TRUE</code> (default), it is assumed that area does not cover
the full extent of the block_xwalk and an additional feature is added with
the difference between the unioned area geometry and unioned block_xwalk
geometry. This additional coverage ensures that blocks are accurately
assigned to this alternate geography but it is excluded from the returned
data frame. If <code>coverage</code> is <code>TRUE</code> and all features in area overlap with
block_xwalk, the function issues a warning and then resets coverage to
<code>FALSE</code>. The reverse option is applied if any features from area do not
overlap</p></dd>


<dt>erase</dt>
<dd><p>If <code>TRUE</code>, apply <code><a href="https://rdrr.io/pkg/tigris/man/erase_water.html" class="external-link">tigris::erase_water()</a></code> to input area and
block_xwalk before joining. Defaults to <code>FALSE</code>. If <code>erase</code> is a sf object,
the geometry of the input sf is erased from area and block_xwalk. This
option is intended to support erasing open space or other non-developed
land as well as water areas.</p></dd>


<dt>area_threshold</dt>
<dd><p>The percentile rank cutoff of water areas to use in the erase operation, ranked by size. Defaults to 0.75, representing the water areas in the 75th percentile and up (the largest 25 percent of areas).  This value may need to be modified by the user to achieve optimal results for a given location.</p></dd>


<dt>keep_geometry</dt>
<dd><p>If <code>TRUE</code>, area_xwalk is a sf object with the same
geometry as the input area. Defaults to <code>FALSE</code>.</p></dd>


<dt>crs</dt>
<dd><p>Coordinate reference system to use for input data. Recommended to
set to a projected CRS if input area data is in a geographic CRS.</p></dd>


<dt>...</dt>
<dd><p>Passed to <code><a href="make_block_xwalk.html">make_block_xwalk()</a></code>.</p></dd>


<dt>data</dt>
<dd><p>A data frame downloaded with <code><a href="https://walker-data.com/tidycensus/reference/get_acs.html" class="external-link">tidycensus::get_acs()</a></code>.</p></dd>


<dt>area_xwalk</dt>
<dd><p>A area crosswalk data frame created with
<code>make_area_xwalk()</code>. Required for <code>use_area_xwalk()</code>.</p></dd>


<dt>geography</dt>
<dd><p>A character string used as general description for area
geography type. Defaults to "area" but typical values could include
"neighborhood", "planning district", or "service area".</p></dd>


<dt>variable_col</dt>
<dd><p>Variable column name. Defaults to "variable"</p></dd>


<dt>value_col, moe_col</dt>
<dd><p>Value and margin of error column names (defaults to
"estimate" and "moe").</p></dd>


<dt>perc</dt>
<dd><p>If <code>TRUE</code> (default), use the denominator column ID to calculate
each estimate as a percent share of the denominator value and use
<code><a href="https://walker-data.com/tidycensus/reference/moe_prop.html" class="external-link">tidycensus::moe_prop()</a></code> to calculate a new margin of error for the percent
estimate.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A tibble or a sf object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Using an area crosswalk</p>
<p>After creating an area crosswalk with <code>make_area_xwalk()</code>, you can pass the
crosswalk to <code>use_area_xwalk()</code> along with a data frame from
<code><a href="https://walker-data.com/tidycensus/reference/get_acs.html" class="external-link">tidycensus::get_acs()</a></code> or <code><a href="get_acs_tables.html">get_acs_tables()</a></code>. At a minimum, the data must
have a column with the same name as geoid_col along with columns named
"variable", "estimate", and "moe".</p>
<p>Please note that this approach to aggregation does <em>not</em> work well if your
data contains "jam" values, e.g. the substitution of 0 for "1939 or older"
for the Median Year Built variable. Ideally, the weight used for aggregation
should be based on household counts when aggregating a household-level
variable and population counts when aggregating a individual-level variable.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://walker-data.com/tidycensus/reference/interpolate_pw.html" class="external-link">tidycensus::interpolate_pw()</a></code>, <code><a href="https://slu-openGIS.github.io/areal/reference/aw_interpolate.html" class="external-link">areal::aw_interpolate()</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Eli Pousson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

